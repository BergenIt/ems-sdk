# Windows manager

## Общее описание модуля расширения

Windows manager - стандартный модуль расширения, предназначеный для обеспечения функционала мониторинга, инвентаризации и управления физических и виртуальных устройств на базе ОС Windows.

1) Мониторинг и сбор данных включает в себя:

   * Получение доступности хоста;
   * Сбор серийного номера;
   * Сбор хостнейма;
   * Сбор модели и вендора;
   * Сбор mac-адресов;
   * Сбор аптайма;
   * Сбор инвентарных данных по ОЗУ;
   * Сбор инвентарных данных по ЦПУ;
   * Сбор инвентарных данных по дискам;
   * Сбор статистики утилизации ЦПУ;
   * Сбор статистики утилизации ОЗУ;
   * Сбор статистики утилизации дискового пространства;
   * Сбор инвентарных данных PCI слотов и устройств;
   * Сбор данных по ОС хоста.

2) Управление включает в себя:

   * Выполнение загруженных пользователем скриптов.

## Используемые технологии

### gRPC

gRPC (Remote Procedure Calls) — это система удалённого вызова процедур (RPC) с открытым исходным кодом, первоначально разработанная в Google в 2015 году.

В качестве транспорта используется HTTP/2, в качестве языка описания интерфейса — Protocol Buffers.

Данный протокол используется для межсервисного общения в системе. Для корректной работы протокола необходимо, чтобы отправляющая и принимающая сторона имели одинаковые протофайлы.

Протофайлы описывают классы и их атрибуты, используемые для общения и выглядят следующим образом:

```bash
syntax = "proto3";

// Описание источника сбора данных.
message DeviceDataIdentity
{
  // Идентификатор устройства.
  string device_id = 1;
  // Идентификатор объекта прав доступа.
  string access_object_id = 2;
}
```

Ссылки:

* <https://grpc.io/>

### WinRM

Удаленное управление Windows (WinRM) — это реализация майкрософт протокола WS-Management, который представляет собой стандартный протокол на основе протокола простого доступа к объектам (SOAP), удобный для брандмауэра, который обеспечивает взаимодействие между оборудованием и операционными системами разных поставщиков.

Спецификация протокола WS-Management предоставляет системам общий способ доступа к данным управления и обмена ими в ит-инфраструктуре. WinRM и стандарт интеллектуального интерфейса управления платформой (IPMI), а также служба сборщика событий являются компонентами набора функций, известных как управление оборудованием.

Ссылки:

* <https://learn.microsoft.com/ru-ru/windows/win32/winrm/portal>
* <https://learn.microsoft.com/ru-ru/windows/win32/winrm/installation-and-configuration-for-windows-remote-management>
* <https://github.com/masterzen/winrm>

## Разработка собственного windows модуля расширения

* [Создание проекта](./golang/create_project/README.md)
* [Реализация операции 'Сбор инвентарных данных по ОЗУ'](./golang/memory_inventory/README.md)
* [Развертывание модуля расширения](./golang/deploy/README.md)
